상황 요약: 현제 신경망이 계속 batch2부터 오류를 내뿜고 있다. delta값이 왜인지 batch 2부터 -Nan를 내벹는다.
아레는 디버깅 로그.


// 2025-07-21자 디버깅 로그.
avgloss += L;
+if(std::isnan(L)){
+    std::cerr << "Loss is NaN at batch " << j << ", epoch " << e << std::endl;
+    std::cerr << "Ypred (first 10 elements): ";
+    Ypred.cpyToHost(); // Ensure host data is valid
+    for(int k=0; k<std::min(10, Ypred.size()); ++k) std::cerr << Ypred.getHostPointer()[k] << " ";
+    std::cerr << std::endl;
+    std::cerr << "labels[j] (first 10 elements): ";
+    labels[j].cpyToHost(); // Ensure host data is valid
+    for(int k=0; k<std::min(10, labels[j].size()); ++k) std::cerr << labels[j].getHostPointer()[k] << " ";
+    std::cerr << std::endl;
+    throw std::runtime_error("invalide error in loss calc.");
+} 
적용 후 컴파일.
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ ./test_compile.sh
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_per 빌드 완료
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_con 빌드 완료
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ cd build
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ ./test_con
[conv] fwdAlgo=1 bwdF=0 bwdD=0 workspace=0MB
[conv] fwdAlgo=1 bwdF=0 bwdD=1 workspace=0MB
[==================================================] 100% [batch loading... (batch 1200/1200)](경과 시간: 191 ms)
[batch load complete]
[>                                                 ] 0% [ | batch1 의 loss:0.349715](경과 시간: 240 ms)
Loss is NaN at batch 1, epoch 1
Ypred (first 10 elements): nan nan nan nan nan nan nan nan nan nan 
labels[j] (first 10 elements): 0 0 0 1 0 0 0 0 0 0 
terminate called after throwing an instance of 'std::runtime_error'
  what():  invalide error in loss calc.
중지됨 (코어 덤프됨)
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ 
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ ./test_compile.sh
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_per 빌드 완료
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(115): error: the object has type qualifiers that are not compatible with the member function "d_matrix_ver2::d_matrix_2<T>::cpyToHost [with T=double]"
            object type is: const d_matrix_ver2::d_matrix_2<double>
          conv1Act.getOutput().cpyToHost();
          ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(116): error: a value of type "const double *" cannot be used to initialize an entity of type "double *"
          double* conv1Act_ptr = conv1Act.getOutput().getHostPointer();
                                 ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(129): error: the object has type qualifiers that are not compatible with the member function "d_matrix_ver2::d_matrix_2<T>::cpyToHost [with T=double]"
            object type is: const d_matrix_ver2::d_matrix_2<double>
          conv2Act.getOutput().cpyToHost();
          ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(130): error: a value of type "const double *" cannot be used to initialize an entity of type "double *"
          double* conv2Act_ptr = conv2Act.getOutput().getHostPointer();
                                 ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(140): error: "flat" has already been declared in the current scope
          auto flat = conv2Act.getOutput().reshape(batch_size, 16*14*14);
               ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(144): error: the object has type qualifiers that are not compatible with the member function "d_matrix_ver2::d_matrix_2<T>::cpyToHost [with T=double]"
            object type is: const d_matrix_ver2::d_matrix_2<double>
          fc1Act.getOutput().cpyToHost();
          ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(145): error: a value of type "const double *" cannot be used to initialize an entity of type "double *"
          double* fc1Act_ptr = fc1Act.getOutput().getHostPointer();
                               ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(158): error: the object has type qualifiers that are not compatible with the member function "d_matrix_ver2::d_matrix_2<T>::cpyToHost [with T=double]"
            object type is: const d_matrix_ver2::d_matrix_2<double>
          fc2Act.getOutput().cpyToHost();
          ^

/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu(159): error: a value of type "const double *" cannot be used to initialize an entity of type "double *"
          double* fc2Act_ptr = fc2Act.getOutput().getHostPointer();
                               ^

9 errors detected in the compilation of "/home/sjh100/바탕화면/explab_ver2/test/test_conv_2.cu".
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ 제시된 코드 흐름에서 오류 발생.

gemini가 제시한 코드 흐름의 오류 수정본.
// 한 배치에 대한 순전파
    d2::d_matrix_2<double> forward(const d2::d_matrix_2<double>& X) {

        conv1.forward(X);
        conv1Act.pushInput(conv1.getOutput()); conv1Act.Active();

        auto forDebugConv1 = conv1.getOutput();
        forDebugConv1.cpyToHost();

        auto forDebugConv1Act = conv1Act.getOutput();
        forDebugConv1Act.cpyToHost();

        double* conv1Act_ptr = forDebugConv1Act.getHostPointer();
        double conv1Act_min = conv1Act_ptr[0], conv1Act_max = conv1Act_ptr[0];
        for(int i=0; i<conv1Act.getOutput().size(); ++i) {
            if(conv1Act_ptr[i] < conv1Act_min) conv1Act_min = conv1Act_ptr[i];
            if(conv1Act_ptr[i] > conv1Act_max) conv1Act_max = conv1Act_ptr[i];
        }
        std::cerr << "conv1Act output min/max: " << conv1Act_min << " / " << conv1Act_max << std::endl;

        // conv2
        conv2.forward(conv1Act.getOutput());
        conv2Act.pushInput(conv2.getOutput()); conv2Act.Active();

        auto forDebugConv2 = conv2.getOutput();
        forDebugConv2.cpyToHost();
        auto forDebugConv2Act = conv2Act.getOutput();
        forDebugConv2Act.cpyToHost();

        // Debug conv2Act output
        double* conv2Act_ptr = forDebugConv2Act.getHostPointer();
        double conv2Act_min = conv2Act_ptr[0], conv2Act_max = conv2Act_ptr[0];
        for(int i=0; i<conv2Act.getOutput().size(); ++i) {
            if(conv2Act_ptr[i] < conv2Act_min) conv2Act_min = conv2Act_ptr[i];
            if(conv2Act_ptr[i] > conv2Act_max) conv2Act_max = conv2Act_ptr[i];
        }
        std::cerr << "conv2Act output min/max: " << conv2Act_min << " / " << conv2Act_max << std::endl;


        // 평탄화 → fc1
        // Debug fc1Act output
        auto flat = conv2Act.getOutput().reshape(batch_size, 16*14*14);
        fc1.feedforward(flat);
        fc1Act.pushInput(fc1.getOutput()); fc1Act.Active();

        auto forDebugfc1Act = fc1Act.getOutput();
        forDebugfc1Act.cpyToHost();
        auto forDebugfc1 = fc1.getOutput();
        forDebugfc1.cpyToHost();

        double* fc1Act_ptr = forDebugfc1Act.getHostPointer();
        double fc1Act_min = fc1Act_ptr[0], fc1Act_max = fc1Act_ptr[0];
        for(int i=0; i<fc1Act.getOutput().size(); ++i) {
            if(fc1Act_ptr[i] < fc1Act_min) fc1Act_min = fc1Act_ptr[i];
            if(fc1Act_ptr[i] > fc1Act_max) fc1Act_max = fc1Act_ptr[i];
        }
        std::cerr << "fc1Act output min/max: " << fc1Act_min << " / " << fc1Act_max << std::endl;


        // fc2
        // Debug fc2Act output
        // 평탄화 → fc1
        fc2.feedforward(fc1Act.getOutput());
        fc2Act.pushInput(fc2.getOutput()); fc2Act.Active();

        auto forDebugfc2Act = fc2Act.getOutput();
        forDebugfc2Act.cpyToHost();
        auto forDebugfc2 = fc2.getOutput();
        forDebugfc2.cpyToHost();

        double* fc2Act_ptr = forDebugfc2Act.getHostPointer();
        double fc2Act_min = fc2Act_ptr[0], fc2Act_max = fc2Act_ptr[0];
        for(int i=0; i<fc2Act.getOutput().size(); ++i) {
            if(fc2Act_ptr[i] < fc2Act_min) fc2Act_min = fc2Act_ptr[i];
            if(fc2Act_ptr[i] > fc2Act_max) fc2Act_max = fc2Act_ptr[i];
        }
        std::cerr << "fc2Act output min/max: " << fc2Act_min << " / " << fc2Act_max << std::endl;

        


        return fc2Act.getOutput();
    }
재시도.
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ ./test_compile.sh
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_per 빌드 완료
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_con 빌드 완료
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ cd build
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ ./test_con
[conv] fwdAlgo=1 bwdF=0 bwdD=0 workspace=0MB
[conv] fwdAlgo=1 bwdF=0 bwdD=1 workspace=0MB
[==================================================] 100% [batch loading... (batch 1200/1200)](경과 시간: 207 ms)
[batch load complete]
conv1Act output min/max: -0.0264278 / 2.00566
conv2Act output min/max: -0.0596767 / 4.9715
fc1Act output min/max: -0.0253983 / 2.29783
fc2Act output min/max: -1.50936 / 1.87753
[>                                                 ] 0% [ | batch1 의 loss:0.233818](경과 시간: 260 ms)
conv1Act output min/max: -0.0266066 / 2.05568
conv2Act output min/max: -0.063747 / 5.08649
fc1Act output min/max: -0.0238478 / 2.15011
fc2Act output min/max: -nan / -nan
Loss is NaN at batch 1, epoch 1
Ypred (first 10 elements): -nan -nan -nan -nan -nan -nan -nan -nan -nan -nan 
labels[j] (first 10 elements): 0 0 0 1 0 0 0 0 0 0 
terminate called after throwing an instance of 'std::runtime_error'
  what():  invalide error in loss calc.
중지됨 (코어 덤프됨)


sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$  cd ..
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ ./test_compile.sh
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_per 빌드 완료
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_con 빌드 완료
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$  cd build
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ ./test_con
[conv] fwdAlgo=1 bwdF=0 bwdD=0 workspace=0MB
[conv] fwdAlgo=1 bwdF=0 bwdD=1 workspace=0MB
[==================================================] 100% [batch loading... (batch 1200/1200)](경과 시간: 184 ms)
[batch load complete]
conv1Act output min/max: -0.0323104 / 2.25604
conv2Act output min/max: -0.0393884 / 3.17037
flat output min/max: -0.0393884 / 3.17037
fc1Act output min/max: -0.0188219 / 1.61787
fc2Act output min/max: -1.02875 / 1.2618
[>                                                 ] 0% [ | batch1 의 loss:0.245428](경과 시간: 237 ms)
conv1Act output min/max: -0.0322704 / 2.27793
conv2Act output min/max: -0.0387191 / 3.12946
flat output min/max: -0.0387191 / 3.12946
fc1Act output min/max: -0.0173438 / 1.67096
fc2Act output min/max: -0.970588 / 1.32884
[>                                                 ] 0% [ | batch2 의 loss:0.234813](경과 시간: 257 ms)
conv1Act output min/max: -0.0333335 / 2.41112
conv2Act output min/max: -0.0393707 / 3.24732
flat output min/max: -0.0393707 / 3.24732
fc1Act output min/max: -0.0251825 / 1.88274
fc2Act output min/max: -0.945669 / 1.2893
[>                                                 ] 0% [ | batch3 의 loss:0.241624](경과 시간: 276 ms)
conv1Act output min/max: -0.0334077 / 2.3221
conv2Act output min/max: -0.038333 / 3.1877
flat output min/max: -0.038333 / 3.1877
fc1Act output min/max: -0.0182822 / 2.32624
fc2Act output min/max: -1.13879 / 1.22303
[>                                                 ] 0% [ | batch4 의 loss:0.253997](경과 시간: 294 ms)
conv1Act output min/max: -0.0321636 / 2.34655
conv2Act output min/max: -0.0424312 / 3.23502
flat output min/max: -0.0424312 / 3.23502
fc1Act output min/max: -0.0165374 / 1.87106
fc2Act output min/max: -0.999354 / 1.3133
[>                                                 ] 0% [ | batch5 의 loss:0.240387](경과 시간: 313 ms)
conv1Act output min/max: -0.0321349 / 2.29604
conv2Act output min/max: -0.039242 / 3.23322
flat output min/max: -0.039242 / 3.23322
fc1Act output min/max: -0.0193074 / 1.74066
fc2Act output min/max: -1.1576 / 1.19398
[>                                                 ] 0% [ | batch6 의 loss:0.227197](경과 시간: 332 ms)
conv1Act output min/max: -0.0324778 / 2.31271
conv2Act output min/max: -0.0407868 / 3.31558
flat output min/max: -0.0407868 / 3.31558
fc1Act output min/max: -0.0197627 / 2.09355
fc2Act output min/max: -0.968648 / 1.25652
[>                                                 ] 0% [ | batch7 의 loss:0.229781](경과 시간: 351 ms)
conv1Act output min/max: -0.0324216 / 2.33598
conv2Act output min/max: -0.0403862 / 3.38526
flat output min/max: -0.0403862 / 3.38526
fc1Act output min/max: -0.0181067 / 1.97345
fc2Act output min/max: -1.16096 / 1.1664
[>                                                 ] 0% [ | batch8 의 loss:0.244588](경과 시간: 370 ms)
conv1Act output min/max: -0.0321073 / 2.26837
conv2Act output min/max: -0.0399594 / 3.33684
flat output min/max: -0.0399594 / 3.33684
fc1Act output min/max: -0.0185245 / 1.90778
fc2Act output min/max: -0.897119 / 1.63409
[>                                                 ] 0% [ | batch9 의 loss:0.232682](경과 시간: 388 ms)
conv1Act output min/max: -0.0324132 / 2.26951
conv2Act output min/max: -0.0390438 / 3.15035
flat output min/max: -0.0390438 / 3.15035
fc1Act output min/max: -0.0175383 / 1.9776
fc2Act output min/max: -1.08214 / 1.34127
[>                                                 ] 0% [ | batch10 의 loss:0.246157](경과 시간: 407 ms)
conv1Act output min/max: -0.0319576 / 2.31262
conv2Act output min/max: -0.0431769 / 3.2531
flat output min/max: -0.0431769 / 3.2531
fc1Act output min/max: -0.0170896 / 1.87216
fc2Act output min/max: -1.07428 / 1.30504
[>                                                 ] 0% [ | batch11 의 loss:0.243874](경과 시간: 426 ms)
conv1Act output min/max: -0.031884 / 2.30682
conv2Act output min/max: -0.0389848 / 3.21429
flat output min/max: -0.0389848 / 3.21429
fc1Act output min/max: -0.0157461 / 1.83089
fc2Act output min/max: -1.21262 / 1.16663
[>                                                 ] 0% [ | batch12 의 loss:0.238789](경과 시간: 445 ms)
conv1Act output min/max: -0.031616 / 2.41289
conv2Act output min/max: -0.0397671 / 3.21128
flat output min/max: -0.0397671 / 3.21128
fc1Act output min/max: -0.0179932 / 1.74664
fc2Act output min/max: -1.12207 / 1.27798
[>                                                 ] 0% [ | batch13 의 loss:0.241750](경과 시간: 463 ms)
conv1Act output min/max: -0.0317939 / 2.45593
conv2Act output min/max: -0.0410134 / 3.57888
flat output min/max: -0.0410134 / 3.57888
fc1Act output min/max: -0.0214634 / 1.81356
fc2Act output min/max: -0.974887 / 1.20747
[>                                                 ] 0% [ | batch14 의 loss:0.224919](경과 시간: 482 ms)
conv1Act output min/max: -0.0325652 / 2.31018
conv2Act output min/max: -0.0413974 / 3.43259
flat output min/max: -0.0413974 / 3.43259
fc1Act output min/max: -0.0235224 / 2.1783
fc2Act output min/max: -1.12177 / 1.14869
[>                                                 ] 0% [ | batch15 의 loss:0.232634](경과 시간: 500 ms)
conv1Act output min/max: -0.0317927 / 2.2779
conv2Act output min/max: -0.0445078 / 3.28322
flat output min/max: -0.0445078 / 3.28322
fc1Act output min/max: -0.0217095 / 2.1645
fc2Act output min/max: -1.08836 / 1.14137
[>                                                 ] 0% [ | batch16 의 loss:0.230977](경과 시간: 519 ms)
conv1Act output min/max: -0.0324317 / 2.2986
conv2Act output min/max: -0.0428679 / 3.58518
flat output min/max: -0.0428679 / 3.58518
fc1Act output min/max: -0.0176749 / 1.79614
fc2Act output min/max: -1.11959 / 1.31226
[>                                                 ] 0% [ | batch17 의 loss:0.233625](경과 시간: 538 ms)
conv1Act output min/max: -0.0321033 / 2.30681
conv2Act output min/max: -0.0431327 / 3.4251
flat output min/max: -0.0431327 / 3.4251
fc1Act output min/max: -0.0193402 / 1.92953
fc2Act output min/max: -1.00609 / 1.52216
[>                                                 ] 0% [ | batch18 의 loss:0.234239](경과 시간: 556 ms)
conv1Act output min/max: -0.0324797 / 2.30596
conv2Act output min/max: -0.0437667 / 3.24815
flat output min/max: -0.0437667 / 3.24815
fc1Act output min/max: -0.0196235 / 1.78855
fc2Act output min/max: -1.26085 / 1.23215
[>                                                 ] 0% [ | batch19 의 loss:0.240696](경과 시간: 575 ms)
conv1Act output min/max: -0.0324253 / 2.30819
conv2Act output min/max: -0.0433563 / 3.62549
flat output min/max: -0.0433563 / 3.62549
fc1Act output min/max: -0.0226588 / 1.95137
fc2Act output min/max: -1.30418 / 1.38566
[>                                                 ] 0% [ | batch20 의 loss:0.235227](경과 시간: 594 ms)
conv1Act output min/max: -0.0320794 / 2.35925
conv2Act output min/max: -0.0450031 / 3.39644
flat output min/max: -0.0450031 / 3.39644
fc1Act output min/max: -0.0195018 / 1.75839
fc2Act output min/max: -1.1323 / 1.40178
[>                                                 ] 0% [ | batch21 의 loss:0.237266](경과 시간: 613 ms)
conv1Act output min/max: -0.0326804 / 2.35806
conv2Act output min/max: -0.0461908 / 3.234
flat output min/max: -0.0461908 / 3.234
fc1Act output min/max: -0.0182992 / 1.72224
fc2Act output min/max: -1.12079 / 1.2905
[>                                                 ] 0% [ | batch22 의 loss:0.230528](경과 시간: 631 ms)
conv1Act output min/max: -0.0342248 / 2.3148
conv2Act output min/max: -0.0482536 / 3.29004
flat output min/max: -0.0482536 / 3.29004
fc1Act output min/max: -0.0193404 / 1.67134
fc2Act output min/max: -1.22233 / 1.33271
[>                                                 ] 0% [ | batch23 의 loss:0.239043](경과 시간: 650 ms)
conv1Act output min/max: -0.0323864 / 2.33494
conv2Act output min/max: -0.0474462 / 3.52369
flat output min/max: -0.0474462 / 3.52369
fc1Act output min/max: -0.0206517 / 1.94699
fc2Act output min/max: -1.50254 / 1.12884
[>                                                 ] 0% [ | batch24 의 loss:0.230370](경과 시간: 669 ms)
conv1Act output min/max: -0.0329858 / 2.36954
conv2Act output min/max: -0.0501291 / 3.33915
flat output min/max: -0.0501291 / 3.33915
fc1Act output min/max: -0.0219769 / 1.95418
fc2Act output min/max: -1.16939 / 1.33977
[>                                                 ] 0% [ | batch25 의 loss:0.226827](경과 시간: 688 ms)
conv1Act output min/max: -0.0334774 / 2.37801
conv2Act output min/max: -0.048207 / 3.42674
flat output min/max: -0.048207 / 3.42674
fc1Act output min/max: -0.021687 / 2.25939
fc2Act output min/max: -1.02172 / 1.16713
[>                                                 ] 0% [ | batch26 의 loss:0.235628](경과 시간: 706 ms)
conv1Act output min/max: -0.0333532 / 2.38267
conv2Act output min/max: -0.0482796 / 3.28671
flat output min/max: -0.0482796 / 3.28671
fc1Act output min/max: -0.0197167 / 2.03881
fc2Act output min/max: -0.898798 / 1.6111
[>                                                 ] 0% [ | batch27 의 loss:0.229660](경과 시간: 725 ms)
conv1Act output min/max: -0.033382 / 2.38746
conv2Act output min/max: -0.0493378 / 3.41703
flat output min/max: -0.0493378 / 3.41703
fc1Act output min/max: -0.0209313 / 1.9665
fc2Act output min/max: -0.855751 / 1.14202
[>                                                 ] 0% [ | batch28 의 loss:0.229816](경과 시간: 744 ms)
conv1Act output min/max: -0.0331385 / 2.39937
conv2Act output min/max: -0.0485119 / 3.56484
flat output min/max: -0.0485119 / 3.56484
fc1Act output min/max: -0.0176759 / 1.72353
fc2Act output min/max: -0.989554 / 1.4494
[>                                                 ] 0% [ | batch29 의 loss:0.230881](경과 시간: 762 ms)
conv1Act output min/max: -0.0329138 / 2.44391
conv2Act output min/max: -0.0485929 / 3.68827
flat output min/max: -0.0485929 / 3.68827
fc1Act output min/max: -0.0227622 / 1.86092
fc2Act output min/max: -1.29192 / 1.15328
[>                                                 ] 0% [ | batch30 의 loss:0.245720](경과 시간: 781 ms)
conv1Act output min/max: -0.0333 / 2.42039
conv2Act output min/max: -0.0520915 / 3.25098
flat output min/max: -0.0520915 / 3.25098
fc1Act output min/max: -0.0163335 / 1.67707
fc2Act output min/max: -1.11336 / 1.63647
[>                                                 ] 0% [ | batch31 의 loss:0.235509](경과 시간: 799 ms)
conv1Act output min/max: -0.0340873 / 2.43797
conv2Act output min/max: -0.0507538 / 3.38221
flat output min/max: -0.0507538 / 3.38221
fc1Act output min/max: -0.0218589 / 2.03512
fc2Act output min/max: -1.28393 / 1.30495
[>                                                 ] 0% [ | batch32 의 loss:0.232793](경과 시간: 818 ms)
conv1Act output min/max: -0.0352791 / 2.37832
conv2Act output min/max: -0.0520269 / 3.64929
flat output min/max: -0.0520269 / 3.64929
fc1Act output min/max: -0.0181322 / 1.88086
fc2Act output min/max: -1.50636 / 1.55868
[>                                                 ] 0% [ | batch33 의 loss:0.217900](경과 시간: 837 ms)
conv1Act output min/max: -0.0336127 / 2.47385
conv2Act output min/max: -0.0514068 / 3.71812
flat output min/max: -0.0514068 / 3.71812
fc1Act output min/max: -0.017387 / 1.7359
fc2Act output min/max: -1.13431 / 1.18073
[>                                                 ] 0% [ | batch34 의 loss:0.220143](경과 시간: 856 ms)
conv1Act output min/max: -0.0348975 / 2.37945
conv2Act output min/max: -0.0550647 / 3.53801
flat output min/max: -0.0550647 / 3.53801
fc1Act output min/max: -0.0192564 / 1.84482
fc2Act output min/max: -1.06884 / 1.45314
[>                                                 ] 0% [ | batch35 의 loss:0.217163](경과 시간: 874 ms)
conv1Act output min/max: -0.0339285 / 2.43818
conv2Act output min/max: -0.0547267 / 3.66182
flat output min/max: -0.0547267 / 3.66182
fc1Act output min/max: -0.0207824 / 1.79719
fc2Act output min/max: -1.04018 / 1.45341
[>                                                 ] 0% [ | batch36 의 loss:0.230374](경과 시간: 893 ms)
conv1Act output min/max: -0.0338657 / 2.38018
conv2Act output min/max: -0.0555665 / 3.81502
flat output min/max: -0.0555665 / 3.81502
fc1Act output min/max: -0.0192619 / 1.83453
fc2Act output min/max: -1.18643 / 1.32396
[>                                                 ] 0% [ | batch37 의 loss:0.229810](경과 시간: 912 ms)
conv1Act output min/max: -0.0337724 / 2.47022
conv2Act output min/max: -0.0563506 / 3.38882
flat output min/max: -0.0563506 / 3.38882
fc1Act output min/max: -0.0199962 / 2.09451
fc2Act output min/max: -1.05599 / 1.78053
[>                                                 ] 0% [ | batch38 의 loss:0.230154](경과 시간: 932 ms)
conv1Act output min/max: -0.035752 / 2.44554
conv2Act output min/max: -0.0572751 / 3.35473
flat output min/max: -0.0572751 / 3.35473
fc1Act output min/max: -0.01971 / 2.19476
fc2Act output min/max: -1.06628 / 1.37409
[>                                                 ] 0% [ | batch39 의 loss:0.236977](경과 시간: 953 ms)
conv1Act output min/max: -0.0345692 / 2.41679
conv2Act output min/max: -0.0603695 / 3.57915
flat output min/max: -0.0603695 / 3.57915
fc1Act output min/max: -0.0209317 / 1.97875
fc2Act output min/max: -1.04869 / 1.61089
[>                                                 ] 0% [ | batch40 의 loss:0.228518](경과 시간: 973 ms)
conv1Act output min/max: -0.0351742 / 2.48534
conv2Act output min/max: -0.0597888 / 3.4932
flat output min/max: -0.0597888 / 3.4932
fc1Act output min/max: -0.0207859 / 2.20357
fc2Act output min/max: -1.1253 / 1.15004
[>                                                 ] 0% [ | batch41 의 loss:0.233652](경과 시간: 993 ms)
conv1Act output min/max: -0.0341669 / 2.4623
conv2Act output min/max: -0.0587086 / 3.47711
flat output min/max: -0.0587086 / 3.47711
fc1Act output min/max: -0.0209773 / 1.77552
fc2Act output min/max: -1.11152 / 1.30294
[>                                                 ] 0% [ | batch42 의 loss:0.219717](경과 시간: 1011 ms)
conv1Act output min/max: -0.0340461 / 2.50692
conv2Act output min/max: -0.0585495 / 3.54331
flat output min/max: -0.0585495 / 3.54331
fc1Act output min/max: -0.0206769 / 2.24503
fc2Act output min/max: -1.63959 / 1.4794
[>                                                 ] 0% [ | batch43 의 loss:0.227789](경과 시간: 1030 ms)
conv1Act output min/max: -0.0347126 / 2.4361
conv2Act output min/max: -0.0594955 / 3.49221
flat output min/max: -0.0594955 / 3.49221
fc1Act output min/max: -0.0181151 / 2.10545
fc2Act output min/max: -1.2691 / 1.3741
[>                                                 ] 0% [ | batch44 의 loss:0.219517](경과 시간: 1049 ms)
conv1Act output min/max: -0.0350277 / 2.61764
conv2Act output min/max: -0.0617279 / 3.47533
flat output min/max: -0.0617279 / 3.47533
fc1Act output min/max: -0.0176525 / 1.865
fc2Act output min/max: -1.33173 / 1.38961
[>                                                 ] 0% [ | batch45 의 loss:0.225960](경과 시간: 1067 ms)
conv1Act output min/max: -0.0344297 / 2.44405
conv2Act output min/max: -0.0634859 / 3.46824
flat output min/max: -0.0634859 / 3.46824
fc1Act output min/max: -0.0203771 / 1.96777
fc2Act output min/max: -0.89872 / 1.42589
[>                                                 ] 0% [ | batch46 의 loss:0.228877](경과 시간: 1086 ms)
conv1Act output min/max: -0.034142 / 2.43607
conv2Act output min/max: -0.0610758 / 3.48753
flat output min/max: -0.0610758 / 3.48753
fc1Act output min/max: -0.0194304 / 1.81668
fc2Act output min/max: -1.14284 / 1.4663
[>                                                 ] 0% [ | batch47 의 loss:0.240385](경과 시간: 1104 ms)
conv1Act output min/max: -0.0358375 / 2.58879
conv2Act output min/max: -0.062563 / 3.47872
flat output min/max: -0.062563 / 3.47872
fc1Act output min/max: -0.02018 / 1.8791
fc2Act output min/max: -1.31094 / 1.17241
[>                                                 ] 0% [ | batch48 의 loss:0.226118](경과 시간: 1123 ms)
conv1Act output min/max: -0.0343291 / 2.48671
conv2Act output min/max: -0.0651823 / 3.61665
flat output min/max: -0.0651823 / 3.61665
fc1Act output min/max: -0.0222752 / 1.97097
fc2Act output min/max: -1.01026 / 1.19338
[>                                                 ] 0% [ | batch49 의 loss:0.229185](경과 시간: 1142 ms)
conv1Act output min/max: -0.0350544 / 2.49418
conv2Act output min/max: -0.0655251 / 3.60231
flat output min/max: -0.0655251 / 3.60231
fc1Act output min/max: -0.0209167 / 2.44058
fc2Act output min/max: -1.28208 / 1.29087
[>                                                 ] 0% [ | batch50 의 loss:0.227298](경과 시간: 1160 ms)
conv1Act output min/max: -0.0353951 / 2.52485
conv2Act output min/max: -0.0677132 / 3.87671
flat output min/max: -0.0677132 / 3.87671
fc1Act output min/max: -0.0219183 / 2.11911
fc2Act output min/max: -1.09491 / 1.44425
[>                                                 ] 0% [ | batch51 의 loss:0.217267](경과 시간: 1179 ms)
conv1Act output min/max: -0.0342693 / 2.5115
conv2Act output min/max: -0.0649899 / 3.56747
flat output min/max: -0.0649899 / 3.56747
fc1Act output min/max: -0.025565 / 1.89757
fc2Act output min/max: -1.12212 / 1.28804
[>                                                 ] 0% [ | batch52 의 loss:0.230200](경과 시간: 1198 ms)
conv1Act output min/max: -0.0353651 / 2.55242
conv2Act output min/max: -0.0689111 / 3.70579
flat output min/max: -0.0689111 / 3.70579
fc1Act output min/max: -0.0215859 / 2.32242
fc2Act output min/max: -1.19624 / 1.54218
[>                                                 ] 0% [ | batch53 의 loss:0.231669](경과 시간: 1217 ms)
conv1Act output min/max: -0.0354834 / 2.54931
conv2Act output min/max: -0.0693244 / 3.57622
flat output min/max: -0.0693244 / 3.57622
fc1Act output min/max: -0.0228351 / 2.1735
fc2Act output min/max: -0.978071 / 1.56354
[>                                                 ] 0% [ | batch54 의 loss:0.228799](경과 시간: 1235 ms)
conv1Act output min/max: -0.0351007 / 2.52239
conv2Act output min/max: -0.0716795 / 3.99126
flat output min/max: -0.0716795 / 3.99126
fc1Act output min/max: -0.0190768 / 2.10248
fc2Act output min/max: -1.08426 / 1.54421
[>                                                 ] 0% [ | batch55 의 loss:0.228982](경과 시간: 1254 ms)
conv1Act output min/max: -0.0356407 / 2.56281
conv2Act output min/max: -0.0721957 / 3.8158
flat output min/max: -0.0721957 / 3.8158
fc1Act output min/max: -0.0211728 / 1.97196
fc2Act output min/max: -0.960664 / 1.42806
[>                                                 ] 0% [ | batch56 의 loss:0.229323](경과 시간: 1273 ms)
conv1Act output min/max: -0.0363977 / 2.56008
conv2Act output min/max: -0.073429 / 3.79912
flat output min/max: -0.073429 / 3.79912
fc1Act output min/max: -0.0227406 / 1.91171
fc2Act output min/max: -0.966394 / 1.29014
[>                                                 ] 0% [ | batch57 의 loss:0.217033](경과 시간: 1291 ms)
conv1Act output min/max: -0.0365066 / 2.58289
conv2Act output min/max: -0.0772908 / 3.89858
flat output min/max: -0.0772908 / 3.89858
fc1Act output min/max: -0.0250206 / 2.08073
fc2Act output min/max: -1.3331 / 1.62603
[>                                                 ] 0% [ | batch58 의 loss:0.222317](경과 시간: 1310 ms)
conv1Act output min/max: -0.03517 / 2.5334
conv2Act output min/max: -0.0765154 / 3.58729
flat output min/max: -0.0765154 / 3.58729
fc1Act output min/max: -0.0226712 / 1.88664
fc2Act output min/max: -1.2166 / 1.3314
[>                                                 ] 0% [ | batch59 의 loss:0.229297](경과 시간: 1329 ms)
conv1Act output min/max: -0.0354326 / 2.56781
conv2Act output min/max: -0.0736927 / 3.68015
flat output min/max: -0.0736927 / 3.68015
fc1Act output min/max: -0.0239653 / 1.96935
fc2Act output min/max: -1.07309 / 1.72167
[>                                                 ] 0% [ | batch60 의 loss:0.227270](경과 시간: 1347 ms)
conv1Act output min/max: -0.0362444 / 2.67756
conv2Act output min/max: -0.0777175 / 3.56284
flat output min/max: -0.0777175 / 3.56284
fc1Act output min/max: -0.023977 / 2.17932
fc2Act output min/max: -1.06266 / 1.29092
[>                                                 ] 0% [ | batch61 의 loss:0.225128](경과 시간: 1366 ms)
conv1Act output min/max: -0.0354583 / 2.54685
conv2Act output min/max: -0.0795411 / 4.0111
flat output min/max: -0.0795411 / 4.0111
fc1Act output min/max: -0.0304943 / 2.08542
fc2Act output min/max: -1.30071 / 1.413
[>                                                 ] 0% [ | batch62 의 loss:0.225523](경과 시간: 1384 ms)
conv1Act output min/max: -0.0356485 / 2.57635
conv2Act output min/max: -0.0794001 / 4.12608
flat output min/max: -0.0794001 / 4.12608
fc1Act output min/max: -0.018751 / 2.09911
fc2Act output min/max: -1.11503 / 1.19399
[>                                                 ] 0% [ | batch63 의 loss:0.213378](경과 시간: 1403 ms)
conv1Act output min/max: -0.0359134 / 2.53754
conv2Act output min/max: -0.0820241 / 4.0717
flat output min/max: -0.0820241 / 4.0717
fc1Act output min/max: -0.0196905 / 2.07093
fc2Act output min/max: -1.12898 / 1.32649
[>                                                 ] 0% [ | batch64 의 loss:0.235704](경과 시간: 1422 ms)
conv1Act output min/max: -0.0369036 / 2.6257
conv2Act output min/max: -0.0841323 / 3.99959
flat output min/max: -0.0841323 / 3.99959
fc1Act output min/max: -0.0232907 / 1.88897
fc2Act output min/max: -1.14368 / 1.1003
[>                                                 ] 0% [ | batch65 의 loss:0.209538](경과 시간: 1441 ms)
conv1Act output min/max: -0.0356625 / 2.58633
conv2Act output min/max: -0.0851862 / 3.83688
flat output min/max: -0.0851862 / 3.83688
fc1Act output min/max: -0.0245267 / 1.93566
fc2Act output min/max: -1.22414 / 1.51008
[>                                                 ] 0% [ | batch66 의 loss:0.222925](경과 시간: 1459 ms)
conv1Act output min/max: -0.0367248 / 2.5331
conv2Act output min/max: -0.0914772 / 3.9114
flat output min/max: -0.0914772 / 3.9114
fc1Act output min/max: -0.0278144 / 2.09386
fc2Act output min/max: -1.24319 / 1.40289
[>                                                 ] 0% [ | batch67 의 loss:0.230891](경과 시간: 1478 ms)
conv1Act output min/max: -0.0369739 / 2.59951
conv2Act output min/max: -0.0882786 / 4.16014
flat output min/max: -0.0882786 / 4.16014
fc1Act output min/max: -0.0303513 / 2.11935
fc2Act output min/max: -1.20658 / 1.24387
[>                                                 ] 0% [ | batch68 의 loss:0.225998](경과 시간: 1496 ms)
conv1Act output min/max: -0.0359937 / 2.56322
conv2Act output min/max: -0.0903707 / 3.95278
flat output min/max: -0.0903707 / 3.95278
fc1Act output min/max: -0.0212817 / 1.82234
fc2Act output min/max: -1.44399 / 1.32899
[>                                                 ] 0% [ | batch69 의 loss:0.232700](경과 시간: 1515 ms)
conv1Act output min/max: -0.0373076 / 2.65314
conv2Act output min/max: -0.0881304 / 3.90609
flat output min/max: -0.0881304 / 3.90609
fc1Act output min/max: -0.0228052 / 1.95209
fc2Act output min/max: -1.06348 / 1.2462
[>                                                 ] 0% [ | batch70 의 loss:0.226244](경과 시간: 1534 ms)
conv1Act output min/max: -0.0372864 / 2.59913
conv2Act output min/max: -0.0905152 / 3.88786
flat output min/max: -0.0905152 / 3.88786
fc1Act output min/max: -0.0271044 / 2.09286
fc2Act output min/max: -1.36385 / 1.39313
[>                                                 ] 0% [ | batch71 의 loss:0.221339](경과 시간: 1553 ms)
conv1Act output min/max: -0.0366257 / 2.58727
conv2Act output min/max: -0.0949885 / 4.11283
flat output min/max: -0.0949885 / 4.11283
fc1Act output min/max: -0.0235073 / 2.28371
fc2Act output min/max: -1.36924 / 1.57721
[>                                                 ] 0% [ | batch72 의 loss:0.220097](경과 시간: 1571 ms)
conv1Act output min/max: -0.0378426 / 2.62088
conv2Act output min/max: -0.0955422 / 3.95272
flat output min/max: -0.0955422 / 3.95272
fc1Act output min/max: -0.0273789 / 2.14697
fc2Act output min/max: -1.38386 / 1.36554
[>                                                 ] 0% [ | batch73 의 loss:0.226482](경과 시간: 1590 ms)
conv1Act output min/max: -0.037489 / 2.64601
conv2Act output min/max: -0.0982107 / 4.48045
flat output min/max: -0.0982107 / 4.48045
fc1Act output min/max: -0.0247484 / 2.50166
fc2Act output min/max: -1.39555 / 1.44723
[>                                                 ] 0% [ | batch74 의 loss:0.226369](경과 시간: 1609 ms)
conv1Act output min/max: -0.0380135 / 2.76371
conv2Act output min/max: -0.0998968 / 4.36931
flat output min/max: -0.0998968 / 4.36931
fc1Act output min/max: -0.0253831 / 2.26143
fc2Act output min/max: -1.17134 / 1.42933
[>                                                 ] 0% [ | batch75 의 loss:0.217825](경과 시간: 1628 ms)
conv1Act output min/max: -0.0387534 / 2.76413
conv2Act output min/max: -0.101545 / 4.1571
flat output min/max: -0.101545 / 4.1571
fc1Act output min/max: -0.0232295 / 2.1166
fc2Act output min/max: -1.47646 / 1.64644
[>                                                 ] 0% [ | batch76 의 loss:0.232130](경과 시간: 1646 ms)
conv1Act output min/max: -0.0367184 / 2.68555
conv2Act output min/max: -0.101279 / 4.15811
flat output min/max: -0.101279 / 4.15811
fc1Act output min/max: -0.0234591 / 2.07903
fc2Act output min/max: -1.1906 / 1.56823
[>                                                 ] 0% [ | batch77 의 loss:0.219279](경과 시간: 1665 ms)
conv1Act output min/max: -0.0381717 / 2.79782
conv2Act output min/max: -0.104829 / 4.19206
flat output min/max: -0.104829 / 4.19206
fc1Act output min/max: -0.0273873 / 2.17678
fc2Act output min/max: -1.30039 / 1.40995
[>                                                 ] 0% [ | batch78 의 loss:0.215228](경과 시간: 1684 ms)
conv1Act output min/max: -0.0374317 / 2.6923
conv2Act output min/max: -0.10386 / 4.13234
flat output min/max: -0.10386 / 4.13234
fc1Act output min/max: -0.0245734 / 1.93433
fc2Act output min/max: -1.39605 / 1.22178
[>                                                 ] 0% [ | batch79 의 loss:0.214921](경과 시간: 1702 ms)
conv1Act output min/max: -0.0379573 / 2.67669
conv2Act output min/max: -0.101128 / 4.16849
flat output min/max: -0.101128 / 4.16849
fc1Act output min/max: -0.0228871 / 2.30828
fc2Act output min/max: -1.2858 / 1.5145
[>                                                 ] 0% [ | batch80 의 loss:0.228902](경과 시간: 1721 ms)
conv1Act output min/max: -0.0385173 / 2.72958
conv2Act output min/max: -0.109465 / 4.10437
flat output min/max: -0.109465 / 4.10437
fc1Act output min/max: -0.0264156 / 2.15418
fc2Act output min/max: -1.28463 / 1.40496
[>                                                 ] 0% [ | batch81 의 loss:0.217831](경과 시간: 1739 ms)
conv1Act output min/max: -0.0383262 / 2.74806
conv2Act output min/max: -0.109017 / 4.30636
flat output min/max: -0.109017 / 4.30636
fc1Act output min/max: -0.0249347 / 2.3172
fc2Act output min/max: -1.09775 / 2.23464
[>                                                 ] 0% [ | batch82 의 loss:0.220901](경과 시간: 1758 ms)
conv1Act output min/max: -0.0378327 / 2.80372
conv2Act output min/max: -0.117789 / 4.4862
flat output min/max: -0.117789 / 4.4862
fc1Act output min/max: -0.0258201 / 2.32475
fc2Act output min/max: -1.46356 / 1.84747
[>                                                 ] 0% [ | batch83 의 loss:0.223743](경과 시간: 1777 ms)
conv1Act output min/max: -0.0385032 / 2.79261
conv2Act output min/max: -0.108974 / 4.2551
flat output min/max: -0.108974 / 4.2551
fc1Act output min/max: -0.0232878 / 2.07261
fc2Act output min/max: -1.2094 / 1.33564
[>                                                 ] 0% [ | batch84 의 loss:0.216472](경과 시간: 1796 ms)
conv1Act output min/max: -0.0378003 / 2.72088
conv2Act output min/max: -0.113557 / 4.24206
flat output min/max: -0.113557 / 4.24206
fc1Act output min/max: -0.0241056 / 2.11912
fc2Act output min/max: -1.1035 / 1.5337
[>                                                 ] 0% [ | batch85 의 loss:0.210452](경과 시간: 1814 ms)
conv1Act output min/max: -0.0382934 / 2.7074
conv2Act output min/max: -0.113726 / 4.81137
flat output min/max: -0.113726 / 4.81137
fc1Act output min/max: -0.0278649 / 2.19162
fc2Act output min/max: -1.5497 / 1.47083
[>                                                 ] 0% [ | batch86 의 loss:0.219425](경과 시간: 1833 ms)
conv1Act output min/max: -0.0381772 / 2.7911
conv2Act output min/max: -0.119893 / 4.22211
flat output min/max: -0.119893 / 4.22211
fc1Act output min/max: -0.0253062 / 2.02505
fc2Act output min/max: -1.37984 / 1.53687
[>                                                 ] 0% [ | batch87 의 loss:0.217522](경과 시간: 1852 ms)
conv1Act output min/max: -0.0386468 / 2.7735
conv2Act output min/max: -0.116716 / 4.61664
flat output min/max: -0.116716 / 4.61664
fc1Act output min/max: -0.0236687 / 2.55445
fc2Act output min/max: -1.33019 / 1.51437
[>                                                 ] 0% [ | batch88 의 loss:0.208617](경과 시간: 1871 ms)
conv1Act output min/max: -0.0385206 / 2.75024
conv2Act output min/max: -0.123391 / 5.17772
flat output min/max: -0.123391 / 5.17772
fc1Act output min/max: -0.0216048 / 2.88132
fc2Act output min/max: -1.45408 / 1.60533
[>                                                 ] 0% [ | batch89 의 loss:0.222002](경과 시간: 1890 ms)
conv1Act output min/max: -0.0387029 / 2.76165
conv2Act output min/max: -0.123453 / 4.35289
flat output min/max: -0.123453 / 4.35289
fc1Act output min/max: -0.024396 / 2.47462
fc2Act output min/max: -1.51103 / 1.84698
[>                                                 ] 0% [ | batch90 의 loss:0.220725](경과 시간: 1908 ms)
conv1Act output min/max: -0.0405511 / 2.76661
conv2Act output min/max: -0.129803 / 4.73876
flat output min/max: -0.129803 / 4.73876
fc1Act output min/max: -0.0251217 / 2.61145
fc2Act output min/max: -1.17929 / 1.60478
[>                                                 ] 0% [ | batch91 의 loss:0.210501](경과 시간: 1927 ms)
conv1Act output min/max: -0.0394044 / 2.82818
conv2Act output min/max: -0.130479 / 4.92574
flat output min/max: -0.130479 / 4.92574
fc1Act output min/max: -0.0259134 / 2.6249
fc2Act output min/max: -1.34093 / 1.71483
^Z
[2]+  멈춤                  ./test_con
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$  cd ..
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ ./test_compile.sh
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_per 빌드 완료
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_con 빌드 완료
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ cd build
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ ./test_con
[conv] fwdAlgo=1 bwdF=0 bwdD=0 workspace=0MB
[conv] fwdAlgo=1 bwdF=0 bwdD=1 workspace=0MB
[==================================================] 100% [batch loading... (batch 1200/1200)](경과 시간: 207 ms)
[batch load complete]
conv1Act output min/max: -0.033511 / 2.31124
conv2Act output min/max: -0.0588213 / 7.27004
fc1Act output min/max: -0.0285383 / 2.60543
fc2Act output min/max: -3.73088 / 1.98169
[>                                                 ] 0% [ | batch1 의 loss:0.289765](경과 시간: 261 ms)
conv1Act output min/max: -0.0340154 / 2.3435
conv2Act output min/max: -0.0620283 / 7.28636
fc1Act output min/max: -0.0276826 / 2.74583
fc2Act output min/max: -nan / -nan
Loss is NaN at batch 1, epoch 1
Ypred (first 10 elements): -nan -nan -nan -nan -nan -nan -nan -nan -nan -nan 
labels[j] (first 10 elements): 0 0 0 1 0 0 0 0 0 0 
terminate called after throwing an instance of 'std::runtime_error'
  what():  invalide error in loss calc.
중지됨 (코어 덤프됨)

아무레도 모든 feedforward줄에 동기화를 하지 않아서 생긴 것 같다.
그래서 코드 흐름을 이렇게 수정하고 다시 컴파일 후 실행해봤다.
    d2::d_matrix_2<double> forward(const d2::d_matrix_2<double>& X) {

        conv1.forward(X);
        conv1Act.pushInput(conv1.getOutput()); conv1Act.Active();
        cudaDeviceSynchronize();

        auto forDebugConv1 = conv1.getOutput();
        forDebugConv1.cpyToHost();

        auto forDebugConv1Act = conv1Act.getOutput();
        forDebugConv1Act.cpyToHost();

        double* conv1Act_ptr = forDebugConv1Act.getHostPointer();
        double conv1Act_min = conv1Act_ptr[0], conv1Act_max = conv1Act_ptr[0];
        for(int i=0; i<conv1Act.getOutput().size(); ++i) {
            if(conv1Act_ptr[i] < conv1Act_min) conv1Act_min = conv1Act_ptr[i];
            if(conv1Act_ptr[i] > conv1Act_max) conv1Act_max = conv1Act_ptr[i];
        }
        std::cerr << "conv1Act output min/max: " << conv1Act_min << " / " << conv1Act_max << std::endl;

        // conv2
        conv2.forward(conv1Act.getOutput());
        conv2Act.pushInput(conv2.getOutput()); conv2Act.Active();
        cudaDeviceSynchronize();

        auto forDebugConv2 = conv2.getOutput();
        forDebugConv2.cpyToHost();
        auto forDebugConv2Act = conv2Act.getOutput();
        forDebugConv2Act.cpyToHost();

        // Debug conv2Act output
        double* conv2Act_ptr = forDebugConv2Act.getHostPointer();
        double conv2Act_min = conv2Act_ptr[0], conv2Act_max = conv2Act_ptr[0];
        for(int i=0; i<conv2Act.getOutput().size(); ++i) {
            if(conv2Act_ptr[i] < conv2Act_min) conv2Act_min = conv2Act_ptr[i];
            if(conv2Act_ptr[i] > conv2Act_max) conv2Act_max = conv2Act_ptr[i];
        }
        std::cerr << "conv2Act output min/max: " << conv2Act_min << " / " << conv2Act_max << std::endl;


        // 평탄화 → fc1
        auto flat = conv2Act.getOutput().reshape(batch_size, 16*14*14);
        fc1.feedforward(flat);
        fc1Act.pushInput(fc1.getOutput()); fc1Act.Active();
        cudaDeviceSynchronize();

        auto forDebugfc1Act = fc1Act.getOutput();
        forDebugfc1Act.cpyToHost();
        auto forDebugfc1 = fc1.getOutput();
        forDebugfc1.cpyToHost();

        double* fc1Act_ptr = forDebugfc1Act.getHostPointer();
        double fc1Act_min = fc1Act_ptr[0], fc1Act_max = fc1Act_ptr[0];
        for(int i=0; i<fc1Act.getOutput().size(); ++i) {
            if(fc1Act_ptr[i] < fc1Act_min) fc1Act_min = fc1Act_ptr[i];
            if(fc1Act_ptr[i] > fc1Act_max) fc1Act_max = fc1Act_ptr[i];
        }
        std::cerr << "fc1Act output min/max: " << fc1Act_min << " / " << fc1Act_max << std::endl;


        // fc2
        // Debug fc2Act output
        // 평탄화 → fc1
        fc2.feedforward(fc1Act.getOutput());
        fc2Act.pushInput(fc2.getOutput()); fc2Act.Active();
        cudaDeviceSynchronize();

        auto forDebugfc2Act = fc2Act.getOutput();
        forDebugfc2Act.cpyToHost();
        auto forDebugfc2 = fc2.getOutput();
        forDebugfc2.cpyToHost();

        double* fc2Act_ptr = forDebugfc2Act.getHostPointer();
        double fc2Act_min = fc2Act_ptr[0], fc2Act_max = fc2Act_ptr[0];
        for(int i=0; i<fc2Act.getOutput().size(); ++i) {
            if(fc2Act_ptr[i] < fc2Act_min) fc2Act_min = fc2Act_ptr[i];
            if(fc2Act_ptr[i] > fc2Act_max) fc2Act_max = fc2Act_ptr[i];
        }
        std::cerr << "fc2Act output min/max: " << fc2Act_min << " / " << fc2Act_max << std::endl;

        


        return fc2Act.getOutput();
    }

sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$  cd ..
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ ./test_compile.sh
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_per 빌드 완료
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_con 빌드 완료
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ cd build
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ ./test_con
[conv] fwdAlgo=1 bwdF=0 bwdD=0 workspace=0MB
[conv] fwdAlgo=1 bwdF=0 bwdD=1 workspace=0MB
[==================================================] 100% [batch loading... (batch 1200/1200)](경과 시간: 178 ms)
[batch load complete]
conv1Act output min/max: -0.0249436 / 2.8606
conv2Act output min/max: -0.0773296 / 7.41778
fc1Act output min/max: -0.0401323 / 4.30667
fc2Act output min/max: -3.13059 / 2.35367
[>                                                 ] 0% [ | batch1 의 loss:0.268799](경과 시간: 230 ms)
conv1Act output min/max: -0.0252575 / 2.8625
conv2Act output min/max: -0.0739817 / 7.92601
fc1Act output min/max: -0.0520957 / 4.01938
fc2Act output min/max: -nan / -nan
Loss is NaN at batch 1, epoch 1
Ypred (first 10 elements): -nan -nan -nan -nan -nan -nan -nan -nan -nan -nan 
labels[j] (first 10 elements): 0 0 0 1 0 0 0 0 0 0 
terminate called after throwing an instance of 'std::runtime_error'
  what():  invalide error in loss calc.
중지됨 (코어 덤프됨)

addBias 주석 처리 후,

sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$  cd ..
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ ./test_compile.sh
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_per 빌드 완료
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
✅ build/test_con 빌드 완료
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2$ cd build
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ ./test_con
[conv] fwdAlgo=1 bwdF=0 bwdD=0 workspace=0MB
[conv] fwdAlgo=1 bwdF=0 bwdD=1 workspace=0MB
[==================================================] 100% [batch loading... (batch 1200/1200)](경과 시간: 125 ms)
[batch load complete]
conv1Act output min/max: -0.0111653 / 2.38152
conv2Act output min/max: -0.0733753 / 6.61396
fc1Act output min/max: -0.0420316 / 4.40038
fc2Act output min/max: -4.50306 / 4.78654
[>                                                 ] 0% [ | batch1 의 loss:0.308504](경과 시간: 177 ms)
conv1Act output min/max: -0.0107824 / 2.40119
conv2Act output min/max: -0.0732146 / 6.76685
fc1Act output min/max: -0.0376646 / 4.36427
fc2Act output min/max: nan / nan
Loss is NaN at batch 1, epoch 1
Ypred (first 10 elements): nan nan nan nan nan nan nan nan nan nan 
labels[j] (first 10 elements): 0 0 0 1 0 0 0 0 0 0 
terminate called after throwing an instance of 'std::runtime_error'
  what():  invalide error in loss calc.
중지됨 (코어 덤프됨)
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$ 

이후 내가 내린 결론: addBias커널은 문제가 아니다. 아무래도 flat 부분에서
auto flat = conv2Act.getOutput().reshape(batch_size, 16*14*14);//이 부분에 대한 연산이 끝나지 않고
fc1.feedforward(flat);// 바로 넘어감.
fc1Act.pushInput(fc1.getOutput()); fc1Act.Active();

라고 판단하여 다음과 같이 수정.
auto flat = conv2Act.getOutput().reshape(batch_size, 16*14*14);
cudaDeviceSynchronize();
fc1.feedforward(flat);
fc1Act.pushInput(fc1.getOutput()); fc1Act.Active();

이후에 실행 해보니...

...
conv1Act output min/max: -0.0210078 / 3.70968
conv2Act output min/max: -0.141463 / 13.2218
fc1Act output min/max: -0.151691 / 14.014
fc2Act output min/max: -4.04845 / 6.0882
[>                                                 ] 0% [ | batch71 의 loss:0.202665](경과 시간: 1507 ms)
conv1Act output min/max: -0.0216095 / 3.73053
conv2Act output min/max: -0.138778 / 13.1029
fc1Act output min/max: -0.136696 / 13.889
fc2Act output min/max: -4.65875 / 8.23675
[>                                                 ] 0% [ | batch72 의 loss:0.202980](경과 시간: 1525 ms)
conv1Act output min/max: -0.0217013 / 3.80883
conv2Act output min/max: -0.140992 / 13.2159
fc1Act output min/max: -0.145304 / 13.7913
fc2Act output min/max: -4.03401 / 7.30877
[>                                                 ] 0% [ | batch73 의 loss:0.206116](경과 시간: 1544 ms)
conv1Act output min/max: -0.021676 / 3.8086
conv2Act output min/max: -0.13825 / 13.4222
fc1Act output min/max: -0.144952 / 13.2524
fc2Act output min/max: -3.9616 / 6.99149
[>                                                 ] 0% [ | batch74 의 loss:0.215356](경과 시간: 1562 ms)
conv1Act output min/max: -0.0215128 / 3.70885
conv2Act output min/max: -0.13889 / 13.3533
fc1Act output min/max: -0.121821 / 13.352
fc2Act output min/max: -3.59548 / 6.43307
[>                                                 ] 0% [ | batch75 의 loss:0.228706](경과 시간: 1580 ms)
conv1Act output min/max: -0.0214885 / 3.80235
conv2Act output min/max: -0.143333 / 13.2907
fc1Act output min/max: -0.139112 / 13.4777
fc2Act output min/max: -5.53386 / 5.23444
[>                                                 ] 0% [ | batch76 의 loss:0.176062](경과 시간: 1600 ms)
conv1Act output min/max: -0.020972 / 3.66777
conv2Act output min/max: -0.139504 / 12.9597
fc1Act output min/max: -0.127248 / 14.2048
fc2Act output min/max: -3.89127 / 5.23959
[>                                                 ] 0% [ | batch77 의 loss:0.156717](경과 시간: 1620 ms)
conv1Act output min/max: -0.0218288 / 3.76682
conv2Act output min/max: -0.143584 / 13.1202
fc1Act output min/max: -0.131458 / 13.5587
fc2Act output min/max: -3.88762 / 5.93976
[>                                                 ] 0% [ | batch78 의 loss:0.173258](경과 시간: 1640 ms)
conv1Act output min/max: -0.0224664 / 3.76903
conv2Act output min/max: -0.138329 / 13.1093
fc1Act output min/max: -0.122505 / 13.9388
fc2Act output min/max: -4.69618 / 6.01979
[>                                                 ] 0% [ | batch79 의 loss:0.203345](경과 시간: 1659 ms)
conv1Act output min/max: -0.0221706 / 3.7937
conv2Act output min/max: -0.141766 / 13.1215
fc1Act output min/max: -0.122688 / 12.3301
fc2Act output min/max: -4.7929 / 5.25949
[>                                                 ] 0% [ | batch80 의 loss:0.172209](경과 시간: 1678 ms)
conv1Act output min/max: -0.0228445 / 3.6913
conv2Act output min/max: -0.144326 / 13.1247
fc1Act output min/max: -0.124081 / 13.3466
fc2Act output min/max: -5.26158 / 6.52426
[>                                                 ] 0% [ | batch81 의 loss:0.138981](경과 시간: 1697 ms)
conv1Act output min/max: -0.0214647 / 3.66753
conv2Act output min/max: -0.138258 / 13.3103
fc1Act output min/max: -0.131363 / 14.4483
fc2Act output min/max: -4.17056 / 6.57633
[>                                                 ] 0% [ | batch82 의 loss:0.206215](경과 시간: 1715 ms)
conv1Act output min/max: -0.0215706 / 3.76371
conv2Act output min/max: -0.143292 / 13.2779
fc1Act output min/max: -0.127474 / 12.96
fc2Act output min/max: -4.07652 / 5.649
[>                                                 ] 0% [ | batch83 의 loss:0.140745](경과 시간: 1733 ms)
conv1Act output min/max: -0.0213265 / 3.66925
conv2Act output min/max: -0.138362 / 12.915
fc1Act output min/max: -0.118796 / 14.4156
fc2Act output min/max: -3.84865 / 5.05223
[>                                                 ] 0% [ | batch84 의 loss:0.166427](경과 시간: 1751 ms)
conv1Act output min/max: -0.0209929 / 3.79122
conv2Act output min/max: -0.140858 / 13.2765
fc1Act output min/max: -0.153782 / 13.3862
fc2Act output min/max: -5.24268 / 6.48885
^Z
[3]+  멈춤                  ./test_con
sjh100@sjh100-Legion-5-15IRX9:~/바탕화면/explab_ver2/build$  
정상 작동하였다.
여기서 두 가지의 의문점이 생긴다.
1.현재의 reshape코드가 gpu를 전혀 쓰지 않는다는 점.

d_matrix_2<T> reshape(int newR, int newC) const {//현제 reshape코드. gpu에서 동작하도록 셜계하지 않았음에도 결과에 따르면 마치 cpu가 이 호출을 무시하는 것처럼 보인다.
    if (static_cast<size_t>(newR) * newC != size())
        throw std::invalid_argument("reshape: size mismatch");
    d_matrix_2<T> V = *this;
    V.row = newR;
    V.col = newC;
    return V;
}
2.그럼 fc1레이어에서도 문제가 발생해야 했지만, 실제로 -nan이 출력된 레이어는 fc2레이어 였다는 점.

아직 난 이 의문점이 해결되지 않았다.

